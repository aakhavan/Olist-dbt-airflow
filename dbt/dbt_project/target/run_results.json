{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-09-15T22:04:40.954022Z", "invocation_id": "c0bce8a2-b083-4eab-b60e-ff33bb1eb04e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:38.845780Z", "completed_at": "2025-09-15T22:04:38.890785Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:38.902718Z", "completed_at": "2025-09-15T22:04:39.326706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4921414852142334, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_customers", "compiled": true, "compiled_code": "select\n    customer_id,\n    customer_unique_id,\n    customer_zip_code_prefix,\n    customer_city,\n    customer_state\nfrom `raw`.`olist_customers_dataset`", "relation_name": "`intermediate`.`stg_customers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:38.856595Z", "completed_at": "2025-09-15T22:04:39.004659Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.011298Z", "completed_at": "2025-09-15T22:04:39.333768Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4976484775543213, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_order_items", "compiled": true, "compiled_code": "select\n    order_id,\n    order_item_id,\n    product_id,\n    seller_id,\n    parseDateTimeBestEffortOrNull(shipping_limit_date) as shipping_limit_date,\n    toFloat64OrNull(price) as price,\n    toFloat64OrNull(freight_value) as freight_value,\n    \n    round(cast(toFloat64(price) as decimal(16, 2)), 2)\n as price_dollars\nfrom `raw`.`olist_order_items_dataset`", "relation_name": "`intermediate`.`stg_order_items`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:38.876267Z", "completed_at": "2025-09-15T22:04:38.923673Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:38.940365Z", "completed_at": "2025-09-15T22:04:39.457366Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6181962490081787, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_order_reviews", "compiled": true, "compiled_code": "select\n    review_id,\n    order_id,\n    toInt64OrNull(review_score) as review_score,\n    review_comment_title,\n    review_comment_message,\n    parseDateTimeBestEffortOrNull(review_creation_date) as review_creation_date,\n    parseDateTimeBestEffortOrNull(review_answer_timestamp) as review_answer_timestamp\n\nfrom `raw`.`olist_order_reviews_dataset`", "relation_name": "`intermediate`.`stg_order_reviews`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:38.869831Z", "completed_at": "2025-09-15T22:04:38.889580Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:38.891856Z", "completed_at": "2025-09-15T22:04:39.501903Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6643478870391846, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_order_payments", "compiled": true, "compiled_code": "select\n    order_id,\n    payment_sequential,\n    payment_type,\n    \n    round(cast(toFloat64(payment_value) as decimal(16, 2)), 2)\n as payment_value_dollars\nfrom `raw`.`olist_order_payments_dataset`", "relation_name": "`intermediate`.`stg_order_payments`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:39.437795Z", "completed_at": "2025-09-15T22:04:39.469410Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.483670Z", "completed_at": "2025-09-15T22:04:39.776602Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3962857723236084, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_product_category_name_translation", "compiled": true, "compiled_code": "select\n    product_category_name,\n    product_category_name_english\n\nfrom `raw`.`product_category_name_translation`", "relation_name": "`intermediate`.`stg_product_category_name_translation`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:39.423071Z", "completed_at": "2025-09-15T22:04:39.462428Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.474981Z", "completed_at": "2025-09-15T22:04:39.782968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4058413505554199, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_orders", "compiled": true, "compiled_code": "select\n    order_id,\n    customer_id,\n    order_status,\n    parseDateTimeBestEffortOrNull(order_purchase_timestamp) as order_purchase_timestamp,\n    parseDateTimeBestEffortOrNull(order_approved_at) as order_approved_at,\n    parseDateTimeBestEffortOrNull(order_delivered_carrier_date) as order_delivered_carrier_date,\n    parseDateTimeBestEffortOrNull(order_delivered_customer_date) as order_delivered_customer_date,\n    parseDateTimeBestEffortOrNull(order_estimated_delivery_date) as order_estimated_delivery_date\nfrom `raw`.`olist_orders_dataset`", "relation_name": "`intermediate`.`stg_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:39.523392Z", "completed_at": "2025-09-15T22:04:39.578305Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.581472Z", "completed_at": "2025-09-15T22:04:39.857453Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3536078929901123, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.stg_products", "compiled": true, "compiled_code": "select\n    product_id,\n    product_category_name,\n    toInt64OrNull(product_name_lenght) as product_name_length,\n    toInt64OrNull(product_description_lenght) as product_description_length,\n    toInt64OrNull(product_photos_qty) as product_photos_qty,\n    toFloat64OrNull(product_weight_g) as product_weight_g,\n    toFloat64OrNull(product_length_cm) as product_length_cm,\n    toFloat64OrNull(product_height_cm) as product_height_cm,\n    toFloat64OrNull(product_width_cm) as product_width_cm\n\nfrom `raw`.`olist_products_dataset`", "relation_name": "`intermediate`.`stg_products`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:39.820970Z", "completed_at": "2025-09-15T22:04:39.875827Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.887856Z", "completed_at": "2025-09-15T22:04:40.306504Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4900350570678711, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.fct_orders", "compiled": true, "compiled_code": "-- sql\n\n\nwith order_payments as (\n    select\n        order_id,\n        sum(toFloat64(payment_value_dollars)) as total_amount\n    from `intermediate`.`stg_order_payments`\n    group by 1\n)\n\nselect\n    o.order_id,\n    o.customer_id,\n    o.order_status,\n\n    -- Always non-NULL DateTime for adapter's CAST('timestamp')\n    ifNull(\n      parseDateTimeBestEffortOrNull(nullIf(toString(o.order_purchase_timestamp), '')),\n      toDateTime('1970-01-01 00:00:00')\n    ) as order_purchase_timestamp,\n\n    ifNull(\n      parseDateTimeBestEffortOrNull(nullIf(toString(o.order_approved_at), '')),\n      toDateTime('1970-01-01 00:00:00')\n    ) as order_approved_at,\n\n    ifNull(\n      parseDateTimeBestEffortOrNull(nullIf(toString(o.order_delivered_customer_date), '')),\n      toDateTime('1970-01-01 00:00:00')\n    ) as order_delivered_customer_date,\n\n    ifNull(op.total_amount, 0.0) as total_amount\nfrom `intermediate`.`stg_orders` o\nleft join order_payments op on o.order_id = op.order_id\n\n\n  where order_purchase_timestamp > (select max(order_purchase_timestamp) from `reporting`.`fct_orders`)\n", "relation_name": "`reporting`.`fct_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:39.877144Z", "completed_at": "2025-09-15T22:04:39.944115Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:39.950499Z", "completed_at": "2025-09-15T22:04:40.763396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8912725448608398, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.mart_product_performance", "compiled": true, "compiled_code": "with order_items as (\n    select\n        order_id,\n        product_id,\n        price,\n        freight_value\n    from `intermediate`.`stg_order_items`\n),\n\norder_reviews as (\n    select\n        order_id,\n        avg(review_score) as avg_review_score\n    from `intermediate`.`stg_order_reviews`\n    group by 1\n),\n\ntranslations as (\n    select * from `intermediate`.`stg_product_category_name_translation`\n),\n\n\nproduct_metrics as (\n    select\n        product_id,\n        count(distinct order_id) as total_orders,\n        sum(price) as total_revenue,\n        sum(freight_value) as total_freight_cost,\n        count(order_id) as total_units_sold\n    from order_items\n    group by 1\n),\n\n-- Aggregate review scores, joining through order_items to link reviews to products\nproduct_reviews as (\n    select\n        product_id,\n        avg(avg_review_score) as average_review_score\n    from order_items\n    left join order_reviews using(order_id)\n    group by product_id\n)\n\nselect\n    p.product_id as product_id,\n    t.product_category_name_english as product_category,\n    coalesce(pm.total_units_sold, 0) as total_units_sold,\n    coalesce(pm.total_revenue, 0) as total_revenue,\n    coalesce(pr.average_review_score, 0) as average_review_score\nfrom `intermediate`.`stg_products` p\nleft join product_metrics pm on p.product_id = pm.product_id\nleft join product_reviews pr on p.product_id = pr.product_id\nleft join translations t on p.product_category_name = t.product_category_name\nwhere pm.total_orders is not null -- Only include products that have been sold\norder by total_revenue desc", "relation_name": "`reporting`.`mart_product_performance`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:40.334269Z", "completed_at": "2025-09-15T22:04:40.352131Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:40.364125Z", "completed_at": "2025-09-15T22:04:40.817779Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.49730563163757324, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.mart_monthly_category_revenue", "compiled": true, "compiled_code": "with orders as (\n    select order_id, order_purchase_timestamp from `reporting`.`fct_orders`\n),\n\norder_items as (\n    select order_id, product_id, price from `intermediate`.`stg_order_items`\n),\n\nproducts as (\n    select product_id, product_category_name from `intermediate`.`stg_products`\n),\n\ntranslations as (\n    select * from `intermediate`.`stg_product_category_name_translation`\n)\n\nselect\n    toStartOfMonth(o.order_purchase_timestamp) as order_month,\n    t.product_category_name_english as product_category,\n    sum(oi.price) as total_revenue\nfrom orders o\njoin order_items oi on o.order_id = oi.order_id\njoin products p on oi.product_id = p.product_id\nleft join translations t on p.product_category_name = t.product_category_name\nwhere o.order_purchase_timestamp is not null and t.product_category_name_english is not null\ngroup by 1, 2\norder by 1, 3 desc", "relation_name": "`reporting`.`mart_monthly_category_revenue`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-15T22:04:40.325023Z", "completed_at": "2025-09-15T22:04:40.350687Z"}, {"name": "execute", "started_at": "2025-09-15T22:04:40.352893Z", "completed_at": "2025-09-15T22:04:40.935601Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6169781684875488, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.mart_customer_revenue", "compiled": true, "compiled_code": "\n\nselect\n    assumeNotNull(c.customer_unique_id) as customer_unique_id ,\n    c.customer_state,\n    min(o.order_purchase_timestamp) as first_order_date,\n    max(o.order_purchase_timestamp) as last_order_date,\n    count(o.order_id) as number_of_orders,\n    sum(o.total_amount) as total_revenue\nfrom `reporting`.`fct_orders` o\njoin `intermediate`.`stg_customers` c on o.customer_id = c.customer_id\ngroup by 1, 2\norder by total_revenue desc", "relation_name": "`reporting`.`mart_customer_revenue`"}], "elapsed_time": 2.4790732860565186, "args": {"vars": {}, "partial_parse_file_diff": true, "static_parser": true, "log_path": "/usr/app/dbt/dbt_project/logs", "which": "run", "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "macro_debugging": false, "show_resource_report": false, "print": true, "invocation_command": "dbt run --profiles-dir .", "quiet": false, "empty": false, "log_level": "info", "partial_parse": true, "source_freshness_run_project_hooks": false, "version_check": true, "enable_legacy_logger": false, "project_dir": "/usr/app/dbt/dbt_project", "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "use_colors_file": true, "select": [], "defer": false, "populate_cache": true, "profiles_dir": ".", "log_level_file": "debug", "introspect": true, "require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "use_colors": true, "exclude": [], "cache_selected_only": false, "log_format": "default", "favor_state": false, "printer_width": 80, "log_file_max_bytes": 10485760, "log_format_file": "debug", "strict_mode": false}}