{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-09-16T20:59:35.621659Z", "invocation_id": "b52b3523-5f14-4a22-988c-e7561fe38244", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-16T20:59:34.698692Z", "completed_at": "2025-09-16T20:59:34.730640Z"}, {"name": "execute", "started_at": "2025-09-16T20:59:34.733484Z", "completed_at": "2025-09-16T20:59:35.602408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9066958427429199, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.olist_dbt.mart_product_performance", "compiled": true, "compiled_code": "with order_items as (\n    select\n        oi.order_id,\n        oi.product_id,\n        oi.price,\n        oi.freight_value,\n        o.order_purchase_timestamp\n    from `intermediate`.`stg_order_items` oi\n    join `intermediate`.`stg_orders` o on oi.order_id = o.order_id\n),\n\norder_reviews as (\n    select\n        order_id,\n        avg(review_score) as avg_review_score\n    from `intermediate`.`stg_order_reviews`\n    group by 1\n),\n\ntranslations as (\n    select * from `intermediate`.`stg_product_category_name_translation`\n),\n\nproduct_metrics_by_day as (\n    select\n        product_id,\n        toDate(order_purchase_timestamp) as order_date,\n        count(distinct order_id) as total_orders,\n        sum(price) as total_revenue,\n        count(order_id) as total_units_sold\n    from order_items\n    group by 1, 2\n),\n\nproduct_reviews as (\n    select\n        product_id,\n        avg(avg_review_score) as average_review_score\n    from order_items\n    left join order_reviews using(order_id)\n    group by product_id\n)\n\nselect\n    pm.product_id as product_id,\n    pm.order_date as order_date,\n    t.product_category_name_english as product_category,\n    coalesce(pm.total_units_sold, 0) as total_units_sold,\n    coalesce(pm.total_revenue, 0) as total_revenue,\n    coalesce(pr.average_review_score, 0) as average_review_score\nfrom product_metrics_by_day pm\nleft join `intermediate`.`stg_products` p on p.product_id = pm.product_id\nleft join product_reviews pr on pm.product_id = pr.product_id\nleft join translations t on p.product_category_name = t.product_category_name\nwhere pm.total_orders is not null\norder by 2,3", "relation_name": "`reporting`.`mart_product_performance`"}], "elapsed_time": 1.2641315460205078, "args": {"populate_cache": true, "log_format_file": "debug", "which": "run", "print": true, "printer_width": 80, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "macro_debugging": false, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt run --select mart_product_performance", "select": ["mart_product_performance"], "strict_mode": false, "defer": false, "log_level": "info", "enable_legacy_logger": false, "quiet": false, "version_check": true, "write_json": true, "exclude": [], "static_parser": true, "cache_selected_only": false, "log_path": "/usr/app/dbt/dbt_project/logs", "show_resource_report": false, "profiles_dir": "/usr/app/dbt/dbt_project", "empty": false, "favor_state": false, "introspect": true, "project_dir": "/usr/app/dbt/dbt_project", "partial_parse": true, "log_format": "default", "partial_parse_file_diff": true, "use_colors_file": true, "vars": {}, "log_level_file": "debug", "use_colors": true, "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager"}}